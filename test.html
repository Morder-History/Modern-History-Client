<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Baidu Map</title>
    <style type="text/css">
      html {
        height: 100%;
      }
      body {
        height: 100%;
        margin: 0px;
        padding: 0px;
      }
      #container {
        height: 100%;
      }
    </style>
    <script
      type="text/javascript"
      src="https://api.map.baidu.com/api?v=3.0&ak=IoutUGo6SaFtmhnWZ8cSaPda74aRyPlT"
    ></script>
  </head>
  <body>
    <div id="container"></div>

    <script>
      // 百度地图API功能
      var map = new BMap.Map("container");
      map.centerAndZoom(new BMap.Point(116.3964, 39.9093), 6);
      // 限制地图级别
      map.setMinZoom(5);
      map.setMaxZoom(7);
      map.enableScrollWheelZoom();
      // 复杂的自定义覆盖物
      // 定义自定义覆盖物的构造函数
      function ComplexCustomOverlay(center, length, color) {
        this._center = center;
        this._length = length;
        this._color = color;
      }
      ComplexCustomOverlay.prototype = new BMap.Overlay();
      // 初始化自定义覆盖物
      ComplexCustomOverlay.prototype.initialize = function (map) {
        // 保存map对象实例
        this._map = map;
        // 创建div元素，作为自定义覆盖物的容器
        var div = document.createElement("div");
        div.style.position = "absolute";
        // 可以根据参数设置元素外观
        div.style.width = this._length + "px";
        div.style.height = this._length + "px";
        div.style.opacity = 0.3;
        div.style.borderRadius = "50%";
        div.style.background = this._color;
        // 将div添加到覆盖物容器中
        map.getPanes().markerPane.appendChild(div);
        // 保存div实例
        this._div = div;
        // 需要将div元素作为方法的返回值，当调用该覆盖物的show、
        // hide方法，或者对覆盖物进行移除时，API都将操作此元素。
        return div;
      };
      // 绘制地图覆盖物
      ComplexCustomOverlay.prototype.draw = function () {
        // 根据地理坐标转换为像素坐标，并设置给容器
        var position = this._map.pointToOverlayPixel(this._center);
        this._div.style.left = position.x - this._length / 2 + "px";
        this._div.style.top = position.y - this._length / 2 + "px";
      };
      // 手动控制覆盖物显示隐藏
      ComplexCustomOverlay.prototype.toggle = function () {
        console.log(this._div);
        if (this._div) {
          if (this._div.style.display == "") {
            this.hide();
          } else {
            this.show();
          }
        }
      };
      ComplexCustomOverlay.prototype.addEventListener = function () {
        console.log(11);
      };

      var mySquare = new ComplexCustomOverlay(map.getCenter(), 100, "red");
      let marker1 = new BMap.Marker(new BMap.Point(123.43, 41.8));
      map.addOverlay(marker1);
      map.addOverlay(mySquare);

      map.addEventListener("zoomend", function () {
        // console.log();
        let nowzoom = this.getZoom();
        if (nowzoom >= 6) {
          mySquare._div.style.display = "none";
        } else {
          mySquare._div.style.display = "";
        }
      });
    </script>
  </body>
</html>
